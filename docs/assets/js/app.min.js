"use strict";angular.module("paymentCycle",["ui.router","toastr"]);
"use strict";!function(){function n(n,t,r){var o=this;o.loginMode=!0,o.changeMode=function(){return o.loginMode=!o.loginMode},o.login=function(){return r.login(o.user,function(r){return r?t.addError(r):n.path("/")})},o.signup=function(){return r.signup(o.user,function(r){return r?t.addError(r):n.path("/")})},o.getUser=function(){return r.getUser()},o.logout=function(){return r.logout(function(){return n.path("/")})}}angular.module("paymentCycle").controller("AuthCtrl",["$location","msgs","auth",n])}();
"use strict";angular.module("paymentCycle").constant("consts",{appName:"Budget Manager",version:"1.0",owner:"João Antônio Bezerra Rodrigues",year:"2017",site:"http://joaoabrodrigues.com",apiUrl:"https://payment-cycles.herokuapp.com/api",oapiUrl:"https://payment-cycles.herokuapp.com/oapi",userKey:"_budget_manager_user"}).run(["$rootScope","consts",function(e,o){e.consts=o}]);
"use strict";angular.module("paymentCycle").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,a,e){t.state("dashboard",{url:"/dashboard",templateUrl:"dashboard/dashboard.html"}).state("paymentCycle",{url:"/paymentCycle?page",templateUrl:"paymentCycles/tabs.html"}),e.interceptors.push("handleResponseError")}]).run(["$rootScope","$http","$location","$window","auth",function(t,a,e,o,r){function n(){var t=r.getUser(),n=o.location.href.includes("/auth.html");t||n?t&&!t.isValid&&r.validateToken(t.token,function(r,l){l?(t.isValid=!0,a.defaults.headers.common.Authorization=t.token,n?o.location.href="/":e.path("/dashboard")):o.location.href="/auth.html"}):o.location.href="/auth.html"}n(),t.$on("$locationChangeStart",function(){return n()})}]);
"use strict";!function(){function t(t){var e=this;e.getSummary=function(){t.get("https://payment-cycles.herokuapp.com/api/v1/paymentSummary").then(function(t){var a=t.data,n=a.credit,o=void 0===n?0:n,r=a.debt,c=void 0===r?0:r;e.credit=o,e.debt=c,e.total=o-c})},e.getSummary()}angular.module("paymentCycle").controller("DashboardController",["$http",t])}();
"use strict";!function(){function e(e,t,a,c){var n=this,l="https://payment-cycles.herokuapp.com/api/v1/paymentCycles";n.refresh=function(){var a=parseInt(t.search().page)||1;e.get(l+"?skip="+10*(a-1)+"&limit=10").then(function(t){n.paymentCycle={credits:[{}],debts:[{status:"PENDENTE"}]},n.paymentCycles=t.data,n.calculateValues(),e.get(l+"/count").then(function(e){n.pages=Math.ceil(e.data.value/10),c.show(n,{tabList:!0,tabCreate:!0})})})},n.showTabList=function(){c.show(n,{}),n.refresh()},n.showTabUpdate=function(e){n.paymentCycle=e,n.calculateValues(),c.show(n,{tabUpdate:!0})},n.showTabDelete=function(e){n.paymentCycle=e,n.calculateValues(),c.show(n,{tabDelete:!0})},n.create=function(){e.post(l,n.paymentCycle).then(function(){n.showTabList(),a.addSuccess("Create Successful!")},function(e){a.addError(e.data.errors)})},n.update=function(){var t=l+"/"+n.paymentCycle._id;e.put(t,n.paymentCycle).then(function(){n.refresh(),a.addSuccess("Update Successful!")},function(e){a.addError(e.data.errors)})},n.delete=function(){var t=l+"/"+n.paymentCycle._id;e.delete(t,n.paymentCycle).then(function(){n.refresh(),a.addSuccess("Delete Successful!")},function(e){a.addError(e.data.errors)})},n.addCredit=function(e){n.paymentCycle.credits.splice(e+1,0,{})},n.cloneCredit=function(e,t){var a=t.name,c=t.value;n.paymentCycle.credits.splice(e+1,0,{name:a,value:c}),n.calculateValues()},n.deleteCredit=function(e){n.paymentCycle.credits.length>1?n.paymentCycle.credits.splice(e,1):n.paymentCycle.credits=[{}],n.calculateValues()},n.addDebt=function(e){n.paymentCycle.debts.splice(e+1,0,{})},n.cloneDebt=function(e,t){var a=t.name,c=t.value;n.paymentCycle.debts.splice(e+1,0,{name:a,value:c,status:status}),n.calculateValues()},n.deleteDebt=function(e){n.paymentCycle.debts.length>1?n.paymentCycle.debts.splice(e,1):n.paymentCycle.debts=[{}],n.calculateValues()},n.calculateValues=function(){n.credit=0,n.debt=0,n.paymentCycle&&(n.paymentCycle.credits.forEach(function(e){var t=e.value;n.credit+=!t||isNaN(t)?0:parseFloat(t)}),n.paymentCycle.debts.forEach(function(e){var t=e.value;n.debt+=!t||isNaN(t)?0:parseFloat(t)}),n.total=n.credit-n.debt)},n.refresh()}angular.module("paymentCycle").controller("PaymentCycleCtrl",["$http","$location","msgs","tabs",e])}();
"use strict";angular.module("paymentCycle").component("authField",{bindings:{id:"@",label:"@",type:"@",grid:"@",icon:"@",model:"=",placeholder:"@",hide:"<"},controller:function(){var l=this;this.$onInit=function(){l.iconClasses="glyphicon glyphicon-"+l.icon+" form-control-feedback"}},template:'\n        <div class="form-group has-feedback">\n            <input ng-model="$ctrl.model" id="{{ $ctrl.id }}" class="form-control" type="{{ $ctrl.type }}" placeholder="{{ $ctrl.placeholder }}" ng-hide="$ctrl.hide" />\n            <span class="{{ $ctrl.iconClasses }}"></span>\n        </div>\n    '});
"use strict";!function(){angular.module("paymentCycle").component("contentHeader",{bindings:{title:"@",subtitle:"@"},template:'\n    <section class="content-header">\n      <h1>{{ $ctrl.title }} <small>{{ $ctrl.subtitle }}</small></h1>\n    </section>\n    '})}();
"use strict";!function(){angular.module("paymentCycle").component("field",{bindings:{id:"@",label:"@",grid:"@",placeholder:"@",type:"@",model:"=",readonly:"<"},controller:["gridSystem",function(l){var e=this;this.$onInit=function(){return e.gridClasses=l.toCssClasses(e.grid)}}],template:'\n        <div class="{{ $ctrl.gridClasses }}">\n            <div class="form-group">\n                <label for="{{ $ctrl.id }}">{{ $ctrl.label }}</label>\n                <input id="{{ $ctrl.id }}" class="form-control" placeholder="{{ $ctrl.placeholder }}" type="{{ $ctrl.type }}" ng-model="$ctrl.model" ng-readonly="$ctrl.readonly">\n            </div>\n        </div>\n        '})}();
"use strict";!function(){angular.module("paymentCycle").component("paginator",{bindings:{url:"@",pages:"@"},controller:["$location",function(n){var r=this;this.$onInit=function(){var e=parseInt(r.pages)||1;r.pagesArray=Array(e).fill(0).map(function(n,r){return r+1}),r.current=parseInt(n.search().page)||1,r.needPagination=r.pages>1,r.hasPrev=r.current>1,r.hasNext=r.current<r.pages,r.isCurrent=function(n){return this.current==n}}}],template:'\n            <ul ng-if="$ctrl.needPagination" class="pagination pagination-sm no-margin pull-right">\n                <li ng-if="$ctrl.hasPrev">\n                    <a href="{{ $ctrl.url }}?page={{ $ctrl.current - 1 }}">Previous</a>\n                </li>\n                <li ng-class="{active: $ctrl.isCurrent(index)}" ng-repeat="index in $ctrl.pagesArray">\n                    <a href="{{ $ctrl.url }}?page={{ index }}">{{ index }}</a>\n                </li>\n                <li ng-if="$ctrl.hasNext">\n                    <a href="{{ $ctrl.url }}?page={{ $ctrl.current + 1 }}">Next</a>\n                </li>\n            </ul>\n        '})}();
"use strict";!function(){angular.module("paymentCycle").component("valueBox",{bindings:{grid:"@",colorClass:"@",value:"@",text:"@",iconClass:"@"},controller:["gridSystem",function(s){var n=this;this.$onInit=function(){return n.gridClasses=s.toCssClasses(n.grid)}}],template:'\n    <div class="{{ $ctrl.gridClasses }}">\n      <div class="small-box {{ $ctrl.colorClass }}">\n        <div class="inner">\n          <h3>{{ $ctrl.value }}</h3>\n          <p>{{ $ctrl.text }}</p>\n        </div>\n        <div class="icon">\n          <i class="fa {{ $ctrl.iconClass }}"></i>\n        </div>\n      </div>\n    </div>\n    '})}();
"use strict";!function(){function t(t,n){function o(){return r||(r=JSON.parse(localStorage.getItem(n.userKey))),r}function a(t,n){u("signup",t,n)}function e(t,n){u("login",t,n)}function u(o,a,e){t.post(n.oapiUrl+"/"+o,a).then(function(o){localStorage.setItem(n.userKey,JSON.stringify(o.data)),t.defaults.headers.common.Authorization=o.data.token,e&&e(null,o.data)}).catch(function(t){e&&e(t.data.errors,null)})}function l(o){r=null,localStorage.removeItem(n.userKey),t.defaults.headers.common.Authorization="",o&&o(null)}function i(a,e){a?t.post(n.oapiUrl+"/validateToken",{token:a}).then(function(n){n.data.valid?t.defaults.headers.common.Authorization=o().token:l(),e&&e(null,n.data.valid)}).catch(function(t){e&&e(t.data.errors)}):e&&e("Invalid token")}var r=null;return{signup:a,login:e,logout:l,getUser:o,validateToken:i}}angular.module("paymentCycle").factory("auth",["$http","consts",t])}();
"use strict";angular.module("paymentCycle").factory("gridSystem",[function(){function s(s){var t=s?s.split(" "):[],l="";return t[0]&&(l+="col-xs-"+t[0]+" "),t[1]&&(l+="col-sm-"+t[1]+" "),t[2]&&(l+="col-md-"+t[2]+" "),t[3]&&(l+="col-lg-"+t[3]+" "),l}return{toCssClasses:s}}]);
"use strict";!function(){function e(e,r,n){function o(o){return 403===o.status&&(localStorage.removeItem(n.userKey),r.location.href="/"),e.reject(o)}return{responseError:o}}angular.module("paymentCycle").factory("handleResponseError",["$q","$window","consts",e])}();
"use strict";!function(){function r(r){function n(n,c,t){n instanceof Array?n.forEach(function(n){return r[t](n,c)}):r[t](n,c)}function c(r){n(r,"Success","success")}function t(r){n(r,"Error","error")}return{addSuccess:c,addError:t}}angular.module("paymentCycle").factory("msgs",["toastr",r])}();
"use strict";!function(){function t(){function t(t,a){var e=a.tabList,i=void 0!==e&&e,o=a.tabCreate,b=void 0!==o&&o,n=a.tabUpdate,r=void 0!==n&&n,d=a.tabDelete,u=void 0!==d&&d;t.tabList=i,t.tabCreate=b,t.tabUpdate=r,t.tabDelete=u}return{show:t}}angular.module("paymentCycle").factory("tabs",[t])}();